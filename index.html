<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hyrox Pro V3 - Hyrox Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;800&family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0e14;
            --bg-card: #141821;
            --bg-card-hover: #1a1f2e;
            --bg-exercise: #1c2230;
            --accent-primary: #00ff88;
            --accent-secondary: #00d4ff;
            --accent-warning: #ffaa00;
            --accent-force: #9d4edd;
            --accent-accessory: #ff6b9d;
            --accent-rest: #ff6b35;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --border: #21262d;
            --success: #00ff88;
            --shadow: rgba(0, 255, 136, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 255, 136, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 212, 255, 0.03) 0%, transparent 50%);
            animation: drift 20s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        @keyframes drift {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-5%, 5%) rotate(2deg); }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }
        
        /* Header */
        header {
            margin-bottom: 24px;
            animation: fadeInDown 0.6s ease-out;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .logo {
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: 800;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--accent-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .version-badge {
            padding: 2px 8px;
            background: rgba(0, 255, 136, 0.15);
            border-radius: 4px;
            font-size: 10px;
            letter-spacing: 1px;
        }
        
        h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .race-countdown {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .race-countdown .days {
            color: var(--accent-primary);
            font-weight: 600;
        }
        
        /* Stats Dashboard */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
            animation: fadeIn 0.8s ease-out 0.2s both;
        }
        
        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            transition: all 0.2s;
        }
        
        .stat-card:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
        }
        
        .stat-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }
        
        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 28px;
            font-weight: 700;
            color: var(--accent-primary);
            display: flex;
            align-items: baseline;
            gap: 6px;
        }
        
        .stat-unit {
            font-size: 14px;
            color: var(--text-muted);
        }
        
        .progress-bar {
            margin-top: 8px;
            height: 6px;
            background: var(--bg-exercise);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transition: width 0.5s ease;
        }
        
        /* Filters */
        .filters {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            animation: fadeIn 0.8s ease-out 0.3s both;
        }
        
        .filter-btn {
            padding: 8px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .filter-btn:hover {
            border-color: var(--accent-primary);
            color: var(--text-primary);
        }
        
        .filter-btn.active {
            background: var(--accent-primary);
            color: var(--bg-dark);
            border-color: var(--accent-primary);
        }
        
        /* Week nav */
        .week-nav {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            overflow-x: auto;
            padding-bottom: 8px;
            animation: fadeIn 0.8s ease-out 0.4s both;
        }
        
        .week-nav::-webkit-scrollbar {
            height: 4px;
        }
        
        .week-nav::-webkit-scrollbar-track {
            background: var(--bg-card);
            border-radius: 2px;
        }
        
        .week-nav::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 2px;
        }
        
        .week-btn {
            flex-shrink: 0;
            padding: 10px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
            position: relative;
        }
        
        .week-btn:hover {
            background: var(--bg-card-hover);
            border-color: var(--accent-primary);
            color: var(--text-primary);
            transform: translateY(-1px);
        }
        
        .week-btn.active {
            background: var(--accent-primary);
            color: var(--bg-dark);
            border-color: var(--accent-primary);
            box-shadow: 0 0 20px var(--shadow);
        }
        
        .week-btn .completion-indicator {
            position: absolute;
            top: -4px;
            right: -4px;
            width: 12px;
            height: 12px;
            background: var(--success);
            border-radius: 50%;
            border: 2px solid var(--bg-dark);
            display: none;
        }
        
        .week-btn.completed .completion-indicator {
            display: block;
        }
        
        /* Week display */
        .week-display {
            display: none;
            animation: fadeInUp 0.4s ease-out;
        }
        
        .week-display.active {
            display: block;
        }
        
        .week-header {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .week-title {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 12px;
        }
        
        .week-title h2 {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-primary);
        }
        
        .week-dates {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: var(--text-muted);
        }
        
        .week-progress {
            margin-top: 16px;
        }
        
        .week-progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 13px;
        }
        
        .week-notes {
            margin-top: 16px;
            padding: 12px;
            background: rgba(255, 170, 0, 0.08);
            border-left: 3px solid var(--accent-warning);
            border-radius: 6px;
            font-size: 13px;
            color: var(--text-secondary);
        }
        
        /* Session cards */
        .sessions {
            display: grid;
            gap: 20px;
        }
        
        .session-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .session-card.hidden {
            display: none;
        }
        
        .session-card:hover {
            border-color: var(--accent-secondary);
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.08);
            transform: translateY(-2px);
        }
        
        .session-card.completed {
            border-color: var(--success);
            opacity: 0.9;
        }
        
        .session-header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            background: var(--bg-exercise);
        }
        
        .session-type {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .session-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .session-icon.upper {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .session-icon.lower {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .session-icon.hyrox {
            background: linear-gradient(135deg, #00ff88 0%, #00d4ff 100%);
        }
        
        .session-name {
            font-size: 20px;
            font-weight: 600;
        }
        
        .session-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .session-badge {
            padding: 4px 10px;
            background: rgba(0, 255, 136, 0.1);
            color: var(--accent-primary);
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Checkbox */
        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }
        
        .checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            background: var(--bg-card);
        }
        
        .checkbox:hover {
            border-color: var(--accent-primary);
        }
        
        .checkbox.checked {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
        }
        
        .checkbox.checked::after {
            content: '‚úì';
            color: var(--bg-dark);
            font-weight: bold;
            font-size: 16px;
        }
        
        .checkbox-label {
            font-size: 13px;
            color: var(--text-muted);
        }
        
        /* Exercise list */
        .exercise-list {
            padding: 16px 20px;
        }
        
        .bloc-section {
            margin-bottom: 24px;
        }
        
        .bloc-section:last-child {
            margin-bottom: 0;
        }
        
        .bloc-title {
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .bloc-title.force {
            color: var(--accent-force);
        }
        
        .bloc-title.accessoires {
            color: var(--accent-accessory);
        }
        
        .exercise {
            background: var(--bg-exercise);
            border-radius: 8px;
            padding: 14px 16px;
            margin-bottom: 10px;
            transition: all 0.2s ease;
        }
        
        .exercise:hover {
            background: var(--bg-card-hover);
            transform: translateX(4px);
        }
        
        .exercise:last-child {
            margin-bottom: 0;
        }
        
        .exercise-name {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 6px;
        }
        
        .exercise-details {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: center;
        }
        
        .exercise-stat {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
        }
        
        .stat-label {
            color: var(--text-muted);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent-primary);
            font-weight: 600;
        }
        
        .exercise-notes {
            margin-top: 8px;
            font-size: 12px;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        /* HYROX SPECIFIC STYLES */
        .hyrox-content {
            padding: 20px;
        }
        
        .hyrox-options {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .option-selector {
            flex: 1;
            padding: 16px;
            background: var(--bg-exercise);
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        
        .option-selector:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
        }
        
        .option-selector.selected {
            border-color: var(--accent-primary);
            background: rgba(0, 255, 136, 0.1);
        }
        
        .option-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .option-subtitle {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        .hyrox-section {
            margin-bottom: 20px;
            background: var(--bg-exercise);
            border-radius: 12px;
            padding: 16px;
        }
        
        .hyrox-section-title {
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--accent-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .hyrox-section-content {
            font-size: 13px;
            line-height: 1.8;
            color: var(--text-secondary);
            white-space: pre-line;
        }
        
        .start-session-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--bg-dark);
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 16px;
        }
        
        .start-session-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 255, 136, 0.3);
        }
        
        .start-session-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* TIMER MODAL */
        .timer-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }
        
        .timer-modal.active {
            display: flex;
        }
        
        .timer-container {
            width: 90%;
            max-width: 500px;
            background: var(--bg-card);
            border: 2px solid var(--accent-primary);
            border-radius: 16px;
            padding: 32px;
            text-align: center;
            position: relative;
        }
        
        .timer-close {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 32px;
            height: 32px;
            background: var(--bg-exercise);
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 20px;
            transition: all 0.2s;
        }
        
        .timer-close:hover {
            background: var(--accent-rest);
            color: var(--text-primary);
        }
        
        .timer-info {
            margin-bottom: 24px;
        }
        
        .timer-week {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 4px;
        }
        
        .timer-type {
            font-size: 20px;
            font-weight: 700;
            color: var(--accent-primary);
        }
        
        .timer-display {
            margin: 32px 0;
        }
        
        .timer-current-round {
            font-size: 18px;
            color: var(--text-muted);
            margin-bottom: 16px;
        }
        
        .timer-current-minute {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        
        .timer-time {
            font-family: 'JetBrains Mono', monospace;
            font-size: 72px;
            font-weight: 900;
            color: var(--accent-primary);
            line-height: 1;
            margin-bottom: 24px;
        }
        
        .timer-current-exercise {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .timer-exercise-details {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .timer-controls {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }
        
        .timer-btn {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .timer-btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--bg-dark);
        }
        
        .timer-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 255, 136, 0.3);
        }
        
        .timer-btn-secondary {
            background: var(--bg-exercise);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }
        
        .timer-btn-secondary:hover {
            background: var(--bg-card-hover);
        }
        
        .timer-btn-danger {
            background: var(--accent-rest);
            color: var(--text-primary);
        }
        
        .timer-btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(255, 107, 53, 0.3);
        }
        
        /* Distance View */
        .timer-container.distance-view {
            width: 100%;
            max-width: 100%;
            height: 100vh;
            border-radius: 0;
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .distance-view .timer-time {
            font-size: 120px;
        }
        
        .distance-view .timer-current-exercise {
            font-size: 48px;
            margin-top: 32px;
        }
        
        .distance-view .timer-exercise-details {
            font-size: 32px;
        }
        
        .distance-view .timer-current-round {
            font-size: 32px;
        }
        
        .distance-view .timer-current-minute {
            font-size: 24px;
        }
        
        /* Round History */
        .round-history {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
        }
        
        .round-history-title {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 12px;
        }
        
        .round-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .round-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 12px;
            background: var(--bg-exercise);
            border-radius: 8px;
            font-size: 13px;
        }
        
        .round-number {
            color: var(--text-muted);
        }
        
        .round-time {
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent-primary);
            font-weight: 600;
        }
        
        /* Notes */
        .session-notes {
            margin-top: 16px;
            padding: 16px;
            background: var(--bg-exercise);
            border-radius: 12px;
        }
        
        .notes-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }
        
        .notes-input {
            width: 100%;
            min-height: 80px;
            padding: 12px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 14px;
            resize: vertical;
        }
        
        .notes-input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }
        
        /* History & Stats */
        .hyrox-history {
            margin-top: 20px;
            padding: 16px;
            background: var(--bg-exercise);
            border-radius: 12px;
        }
        
        .history-title {
            font-size: 14px;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 12px;
        }
        
        .history-empty {
            font-size: 13px;
            color: var(--text-muted);
            text-align: center;
            padding: 20px;
        }
        
        .history-item {
            padding: 12px;
            background: var(--bg-card);
            border-radius: 8px;
            margin-bottom: 8px;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .history-date {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        .history-option {
            font-size: 12px;
            font-weight: 600;
            color: var(--accent-primary);
        }
        
        .history-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            font-size: 12px;
        }
        
        .history-stat-label {
            color: var(--text-muted);
        }
        
        .history-stat-value {
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-primary);
            font-weight: 600;
        }
        
        /* Footer */
        footer {
            margin-top: 60px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
            text-align: center;
            color: var(--text-muted);
            font-size: 12px;
        }
        
        /* Animations */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }
            
            h1 {
                font-size: 22px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stat-value {
                font-size: 22px;
            }
            
            .timer-time {
                font-size: 56px;
            }
            
            .distance-view .timer-time {
                font-size: 80px;
            }
            
            .distance-view .timer-current-exercise {
                font-size: 32px;
            }
            
            .distance-view .timer-exercise-details {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <div class="logo">
                    ‚ö° Hyrox Pro 
                    <span class="version-badge">V3 HYROX</span>
                </div>
            </div>
            <h1>Dashboard Entra√Ænement</h1>
            <div class="race-countdown">
                üìç Toulouse ¬∑ <span class="days" id="countdown">--</span> jours restants ¬∑ 22 Mars 2026
            </div>
        </header>
        
        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Progression globale</div>
                <div class="stat-value">
                    <span id="globalProgress">0</span>
                    <span class="stat-unit">%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="globalProgressBar" style="width: 0%"></div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">S√©ances compl√©t√©es</div>
                <div class="stat-value">
                    <span id="completedSessions">0</span>
                    <span class="stat-unit">/ <span id="totalSessions">39</span></span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Semaine actuelle</div>
                <div class="stat-value">
                    <span id="currentWeek">1</span>
                    <span class="stat-unit">/ 13</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">S√©ances Hyrox</div>
                <div class="stat-value">
                    <span id="hyroxCompleted">0</span>
                    <span class="stat-unit">/ 13</span>
                </div>
            </div>
        </div>
        
        <!-- Filters -->
        <div class="filters" id="filters">
            <button class="filter-btn active" onclick="filterSessions('all')">
                <span>üìã</span> Tout
            </button>
            <button class="filter-btn" onclick="filterSessions('upper')">
                <span>üí™</span> Upper
            </button>
            <button class="filter-btn" onclick="filterSessions('lower')">
                <span>ü¶µ</span> Lower
            </button>
            <button class="filter-btn" onclick="filterSessions('hyrox')">
                <span>‚ö°</span> Hyrox
            </button>
        </div>
        
        <!-- Week navigation -->
        <nav class="week-nav" id="weekNav"></nav>
        
        <!-- Week view -->
        <div id="weekContent"></div>
        
        <footer>
            Programme 13 semaines ¬∑ Hyrox Pro Toulouse 2026 ¬∑ V3 HYROX EDITION
        </footer>
    </div>
    
    <!-- Timer Modal -->
    <div class="timer-modal" id="timerModal">
        <div class="timer-container" id="timerContainer">
            <div class="timer-close" onclick="closeTimer()">‚úï</div>
            
            <div class="timer-info">
                <div class="timer-week" id="timerWeek"></div>
                <div class="timer-type" id="timerType"></div>
            </div>
            
            <div class="timer-display">
                <div class="timer-current-round" id="timerRound"></div>
                <div class="timer-current-minute" id="timerMinute"></div>
                <div class="timer-time" id="timerTime">0:00</div>
                <div class="timer-current-exercise" id="timerExercise"></div>
                <div class="timer-exercise-details" id="timerDetails"></div>
            </div>
            
            <div class="timer-controls" id="timerControls"></div>
            
            <div class="round-history" id="roundHistory" style="display:none;">
                <div class="round-history-title">Historique des tours</div>
                <div class="round-list" id="roundList"></div>
            </div>
        </div>
    </div>
    
    <!-- Audio element for bell sound -->
    <audio id="bellSound" preload="auto"></audio>
    
    <script>
        const trainingData = {"musculation": [{"numero": 1, "dates": "22-28 D√©c", "notes": "Campus ~3h. ISCHIO: Skip squash, rameur‚ÜíBike/Ski finishers", "upper": [{"nom": "Bench Press Barre", "series": "4x5", "charge": "92kg", "notes": "Prog: +2kg sem pr√©c√©dente", "bloc": "Force"}, {"nom": "Cable Row Horizontal", "series": "4x6-8", "charge": "70kg", "notes": "Focus contraction dorsaux", "bloc": "Force"}, {"nom": "D√©velopp√© Inclin√© Halt√®res", "series": "3x8", "charge": "2x28kg", "notes": "Tempo contr√¥l√©", "bloc": "Force"}, {"nom": "√âl√©vations Lat√©rales", "series": "3x12", "charge": "2x10kg", "notes": "√âpaules endurance (support WB)", "bloc": "Accessoires"}, {"nom": "Cable Pulldown", "series": "3x10", "charge": "60kg", "notes": "Sled Pull support", "bloc": "Accessoires"}, {"nom": "Face Pulls", "series": "3x15", "charge": "30kg", "notes": "Stabilit√© √©paules", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "4x10", "charge": "70kg", "notes": "Prog: +5kg, remplace Trap Bar", "bloc": "Force"}, {"nom": "Back Squat", "series": "4x6", "charge": "92kg", "notes": "Rotation: Back cette semaine", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "3x8/jambe", "charge": "2x24kg", "notes": "Force unilat√©rale", "bloc": "Force"}, {"nom": "Lunges Pond√©r√©es HALT√àRES", "series": "3x20m", "charge": "2x24kg", "notes": "Force - Halt√®res muscu", "bloc": "Accessoires"}, {"nom": "Goblet Squat", "series": "3x12", "charge": "28kg", "notes": "WB endurance jambes", "bloc": "Accessoires"}, {"nom": "Broad Jumps", "series": "3x5", "charge": "Corps", "notes": "BBJ support - Distance max", "bloc": "Accessoires"}]}, {"numero": 2, "dates": "29 D√©c-4 Jan", "notes": "Campus ~3h. ISCHIO: Toujours prudent rameur/squash", "upper": [{"nom": "Bench Press Barre", "series": "4x5", "charge": "94kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "Tirage Horizontal Poulie", "series": "4x6-8", "charge": "73kg", "notes": "+3kg", "bloc": "Force"}, {"nom": "D√©velopp√© Inclin√© Halt√®res", "series": "3x8", "charge": "2x30kg", "notes": "+2kg/halt√®re", "bloc": "Force"}, {"nom": "D√©velopp√© Halt√®res √âpaules", "series": "4x8", "charge": "2x20kg", "notes": "WB endurance", "bloc": "Accessoires"}, {"nom": "Tirage Vertical", "series": "3x10", "charge": "65kg", "notes": "+5kg", "bloc": "Accessoires"}, {"nom": "√âl√©vations Post√©rieures", "series": "3x15", "charge": "2x8kg", "notes": "Stabilit√©", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "4x10", "charge": "75kg", "notes": "+5kg", "bloc": "Force"}, {"nom": "Back Squat", "series": "4x6", "charge": "95kg", "notes": "+3kg", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "3x8/jambe", "charge": "2x26kg", "notes": "+2kg/halt√®re", "bloc": "Force"}, {"nom": "Lunges Pond√©r√©es HALT√àRES", "series": "3x20m", "charge": "2x26kg", "notes": "+2kg progression", "bloc": "Accessoires"}, {"nom": "Goblet Squat", "series": "3x12", "charge": "30kg", "notes": "+2kg", "bloc": "Accessoires"}, {"nom": "Presse √† Cuisse", "series": "3x10", "charge": "140kg", "notes": "Force pure", "bloc": "Accessoires"}]}, {"numero": 3, "dates": "5-11 Jan", "notes": "Campus HAUTE ~7h. Muscu DELOAD. Test squash l√©ger fin sem?", "upper": [{"nom": "Bench Press Barre", "series": "3x5", "charge": "85kg", "notes": "Volume -20%, charge -10%", "bloc": "Force"}, {"nom": "Tirage Horizontal", "series": "3x6", "charge": "65kg", "notes": "R√©duit", "bloc": "Force"}, {"nom": "D√©velopp√© Inclin√© Halt√®res", "series": "3x6", "charge": "2x24kg", "notes": "L√©ger", "bloc": "Force"}, {"nom": "√âl√©vations Lat√©rales", "series": "3x10", "charge": "2x8kg", "notes": "R√©duit", "bloc": "Accessoires"}, {"nom": "Cable Pulldown", "series": "3x8", "charge": "50kg", "notes": "Technique", "bloc": "Accessoires"}, {"nom": "Face Pulls", "series": "3x12", "charge": "25kg", "notes": "L√©ger", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "3x8", "charge": "65kg", "notes": "Volume -30%", "bloc": "Force"}, {"nom": "Front Squat", "series": "4x6", "charge": "75kg", "notes": "Rotation: Front, D√âCOUVERTE", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "3x6/jambe", "charge": "2x20kg", "notes": "R√©duit", "bloc": "Force"}, {"nom": "Lunges HALT√àRES", "series": "2x20m", "charge": "2x24kg", "notes": "Volume r√©duit", "bloc": "Accessoires"}, {"nom": "Goblet Squat", "series": "3x10", "charge": "24kg", "notes": "L√©ger", "bloc": "Accessoires"}, {"nom": "SKIP Broad Jumps", "series": "", "charge": "", "notes": "R√©cup", "bloc": "Accessoires"}]}, {"numero": 4, "dates": "12-18 Jan", "notes": "Campus DELOAD ~3h. Test rameur 500m si ischio OK", "upper": [{"nom": "Bench Press Barre", "series": "4x5", "charge": "96kg", "notes": "Retour prog +2kg", "bloc": "Force"}, {"nom": "Cable Row", "series": "4x6-8", "charge": "76kg", "notes": "+3kg", "bloc": "Force"}, {"nom": "D√©velopp√© Inclin√© Halt√®res", "series": "3x8", "charge": "2x32kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "D√©velopp√© √âpaules", "series": "4x8", "charge": "2x22kg", "notes": "+2kg", "bloc": "Accessoires"}, {"nom": "Tirage Vertical", "series": "3x10", "charge": "68kg", "notes": "+3kg", "bloc": "Accessoires"}, {"nom": "√âl√©vations Frontales", "series": "3x12", "charge": "2x10kg", "notes": "Nouveau", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "4x10", "charge": "80kg", "notes": "+5kg fort", "bloc": "Force"}, {"nom": "Front Squat", "series": "4x8", "charge": "80kg", "notes": "Prog +5kg", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "3x8/jambe", "charge": "2x28kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "Lunges HALT√àRES", "series": "3x20m", "charge": "2x28kg", "notes": "+2kg", "bloc": "Accessoires"}, {"nom": "Goblet Squat", "series": "3x12", "charge": "32kg", "notes": "+2kg", "bloc": "Accessoires"}, {"nom": "Broad Jumps", "series": "4x5", "charge": "Corps", "notes": "+1 s√©rie", "bloc": "Accessoires"}]}, {"numero": 5, "dates": "19-25 Jan", "notes": "Campus ~7h haute. Ischio devrait √™tre OK maintenant", "upper": [{"nom": "Bench Press Barre", "series": "5x5", "charge": "98kg", "notes": "Volume +25%, +2kg", "bloc": "Force"}, {"nom": "Tirage Horizontal", "series": "4x6", "charge": "80kg", "notes": "+4kg, reps -2", "bloc": "Force"}, {"nom": "D√©velopp√© Inclin√© Halt√®res", "series": "4x6", "charge": "2x34kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "D√©velopp√© √âpaules", "series": "4x8", "charge": "2x24kg", "notes": "+2kg", "bloc": "Accessoires"}, {"nom": "Cable Pulldown", "series": "3x8", "charge": "70kg", "notes": "Lourd", "bloc": "Accessoires"}, {"nom": "√âcart√©s Pectoraux Poulie", "series": "3x12", "charge": "15kg", "notes": "Nouveau", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "5x10", "charge": "85kg", "notes": "Volume +25%", "bloc": "Force"}, {"nom": "Back Squat", "series": "5x5", "charge": "98kg", "notes": "Rotation: Back, +3kg", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "4x8/jambe", "charge": "2x30kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "Lunges HALT√àRES", "series": "4x20m", "charge": "2x28kg", "notes": "Volume +33%", "bloc": "Accessoires"}, {"nom": "Hack Squat", "series": "3x8", "charge": "100kg", "notes": "Nouveau - Force", "bloc": "Accessoires"}, {"nom": "Broad Jumps", "series": "4x5", "charge": "Corps", "notes": "Constance", "bloc": "Accessoires"}]}, {"numero": 6, "dates": "26 Jan-1 F√©v", "notes": "Campus ~8h haute. PRO! 100kg bench/squat. Lunges lourdes!", "upper": [{"nom": "Bench Press Barre", "series": "5x5", "charge": "100kg", "notes": "+2kg - 100kg atteint!", "bloc": "Force"}, {"nom": "Cable Row", "series": "5x6", "charge": "83kg", "notes": "+3kg", "bloc": "Force"}, {"nom": "D√©velopp√© Couch√© Halt√®res", "series": "4x8", "charge": "2x40kg", "notes": "Variante", "bloc": "Force"}, {"nom": "D√©velopp√© √âpaules", "series": "5x6", "charge": "2x26kg", "notes": "Lourd -2 reps", "bloc": "Accessoires"}, {"nom": "Tirage B√ªcheron", "series": "3x10/bras", "charge": "36kg", "notes": "Unilat√©ral", "bloc": "Accessoires"}, {"nom": "Face Pulls", "series": "4x15", "charge": "35kg", "notes": "+5kg", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "5x10", "charge": "90kg", "notes": "+5kg", "bloc": "Force"}, {"nom": "Back Squat", "series": "5x5", "charge": "100kg", "notes": "+2kg - 100kg!", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "4x8/jambe", "charge": "2x32kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "Lunges HALT√àRES", "series": "4x20m", "charge": "2x30kg", "notes": "+2kg - Lourd!", "bloc": "Accessoires"}, {"nom": "Goblet Squat", "series": "4x10", "charge": "36kg", "notes": "+4kg lourd", "bloc": "Accessoires"}, {"nom": "Leg Extension", "series": "3x15", "charge": "60kg", "notes": "Finition quads", "bloc": "Accessoires"}]}, {"numero": 7, "dates": "2-8 F√©v", "notes": "Campus HAUTE ~9h. Muscu DELOAD. R√©cup avant pic", "upper": [{"nom": "Bench Press Barre", "series": "3x5", "charge": "90kg", "notes": "Volume -40%, charge -10%", "bloc": "Force"}, {"nom": "Tirage Horizontal", "series": "3x6", "charge": "75kg", "notes": "R√©duit", "bloc": "Force"}, {"nom": "D√©velopp√© Inclin√© Halt√®res", "series": "3x6", "charge": "2x28kg", "notes": "L√©ger", "bloc": "Force"}, {"nom": "√âl√©vations Lat√©rales", "series": "3x10", "charge": "2x10kg", "notes": "Technique", "bloc": "Accessoires"}, {"nom": "Cable Pulldown", "series": "3x8", "charge": "55kg", "notes": "L√©ger", "bloc": "Accessoires"}, {"nom": "Pompes", "series": "3x10", "charge": "Corps", "notes": "Bodyweight", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "3x8", "charge": "75kg", "notes": "Volume -40%", "bloc": "Force"}, {"nom": "Front Squat", "series": "4x6", "charge": "85kg", "notes": "Rotation: Front, +5kg", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "3x6/jambe", "charge": "2x24kg", "notes": "R√©duit", "bloc": "Force"}, {"nom": "Lunges HALT√àRES", "series": "2x20m", "charge": "2x28kg", "notes": "Volume r√©duit", "bloc": "Accessoires"}, {"nom": "Goblet Squat", "series": "3x8", "charge": "28kg", "notes": "L√©ger", "bloc": "Accessoires"}, {"nom": "SKIP Broad Jumps", "series": "", "charge": "", "notes": "R√©cup", "bloc": "Accessoires"}]}, {"numero": 8, "dates": "9-15 F√©v", "notes": "Campus DELOAD ~3h. Test Hyrox WB prioritaire", "upper": [{"nom": "Bench Press Barre", "series": "5x4", "charge": "103kg", "notes": "Test +3kg, reps -1", "bloc": "Force"}, {"nom": "Cable Row", "series": "5x6", "charge": "85kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "D√©velopp√© Inclin√© Barre", "series": "4x6", "charge": "75kg", "notes": "Barre variante", "bloc": "Force"}, {"nom": "D√©velopp√© √âpaules", "series": "5x6", "charge": "2x28kg", "notes": "+2kg", "bloc": "Accessoires"}, {"nom": "Tirage Vertical", "series": "4x8", "charge": "72kg", "notes": "+4kg", "bloc": "Accessoires"}, {"nom": "√âl√©vations Post√©rieures", "series": "4x12", "charge": "2x10kg", "notes": "+2kg", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "5x10", "charge": "95kg", "notes": "+5kg test", "bloc": "Force"}, {"nom": "Front Squat", "series": "5x6", "charge": "88kg", "notes": "+3kg", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "4x8/jambe", "charge": "2x34kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "Lunges HALT√àRES", "series": "4x20m", "charge": "2x30kg", "notes": "Maintien lourd", "bloc": "Accessoires"}, {"nom": "Presse √† Cuisse", "series": "4x8", "charge": "160kg", "notes": "+20kg lourd", "bloc": "Accessoires"}, {"nom": "Broad Jumps", "series": "4x5", "charge": "Corps", "notes": "Test", "bloc": "Accessoires"}]}, {"numero": 9, "dates": "16-22 F√©v", "notes": "Campus HAUTE MAX ~11h. Pic force muscu", "upper": [{"nom": "Bench Press Barre", "series": "4x4", "charge": "105kg", "notes": "Pic force +2kg", "bloc": "Force"}, {"nom": "Tirage Horizontal", "series": "5x5", "charge": "88kg", "notes": "Force max", "bloc": "Force"}, {"nom": "D√©velopp√© Inclin√© Halt√®res", "series": "4x6", "charge": "2x36kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "D√©velopp√© √âpaules", "series": "5x5", "charge": "2x30kg", "notes": "Lourd WB prep", "bloc": "Accessoires"}, {"nom": "Cable Pulldown", "series": "4x6", "charge": "75kg", "notes": "Sled Pull force", "bloc": "Accessoires"}, {"nom": "Face Pulls", "series": "4x15", "charge": "40kg", "notes": "+5kg", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "5x8", "charge": "100kg", "notes": "+5kg pic", "bloc": "Force"}, {"nom": "Back Squat", "series": "4x4", "charge": "103kg", "notes": "Rotation: Back, +3kg force", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "4x6/jambe", "charge": "2x36kg", "notes": "+2kg lourd", "bloc": "Force"}, {"nom": "Lunges HALT√àRES", "series": "5x20m", "charge": "2x30kg", "notes": "Volume max lourd", "bloc": "Accessoires"}, {"nom": "Goblet Squat", "series": "4x8", "charge": "40kg", "notes": "+4kg", "bloc": "Accessoires"}, {"nom": "Leg Extension", "series": "4x12", "charge": "70kg", "notes": "+10kg", "bloc": "Accessoires"}]}, {"numero": 10, "dates": "23 F√©v-1 Mars", "notes": "Campus ~9h. Simulation Hyrox = PRIORIT√â ABSOLUE", "upper": [{"nom": "Bench Press Barre", "series": "4x3", "charge": "107kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "Cable Row", "series": "5x5", "charge": "90kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "D√©velopp√© Couch√© Halt√®res", "series": "4x6", "charge": "2x42kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "D√©velopp√© √âpaules", "series": "4x6", "charge": "2x30kg", "notes": "Maintien", "bloc": "Accessoires"}, {"nom": "Tirage B√ªcheron", "series": "4x8/bras", "charge": "38kg", "notes": "+2kg", "bloc": "Accessoires"}, {"nom": "√âl√©vations Lat√©rales", "series": "4x10", "charge": "2x12kg", "notes": "+2kg", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "4x8", "charge": "105kg", "notes": "+5kg", "bloc": "Force"}, {"nom": "Back Squat", "series": "4x3", "charge": "105kg", "notes": "+2kg pic", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "4x6/jambe", "charge": "2x38kg", "notes": "+2kg", "bloc": "Force"}, {"nom": "Lunges HALT√àRES", "series": "4x20m", "charge": "2x30kg", "notes": "Maintien", "bloc": "Accessoires"}, {"nom": "Hack Squat", "series": "4x6", "charge": "120kg", "notes": "+20kg", "bloc": "Accessoires"}, {"nom": "Broad Jumps", "series": "5x5", "charge": "Corps", "notes": "Max volume", "bloc": "Accessoires"}]}, {"numero": 11, "dates": "2-8 Mars", "notes": "Campus ~4h descente. TAPER. Fra√Æcheur prioritaire", "upper": [{"nom": "Bench Press Barre", "series": "3x3", "charge": "95kg", "notes": "Volume -50%, charge -12kg", "bloc": "Force"}, {"nom": "Tirage Horizontal", "series": "3x5", "charge": "80kg", "notes": "R√©duit", "bloc": "Force"}, {"nom": "D√©velopp√© Inclin√© Halt√®res", "series": "3x5", "charge": "2x30kg", "notes": "L√©ger", "bloc": "Force"}, {"nom": "D√©velopp√© √âpaules", "series": "3x6", "charge": "2x24kg", "notes": "Technique", "bloc": "Accessoires"}, {"nom": "Cable Pulldown", "series": "3x6", "charge": "60kg", "notes": "L√©ger", "bloc": "Accessoires"}, {"nom": "SKIP Face Pulls", "series": "", "charge": "", "notes": "Minimal", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "3x6", "charge": "85kg", "notes": "Volume -50%", "bloc": "Force"}, {"nom": "Front Squat", "series": "3x5", "charge": "90kg", "notes": "Rotation: Front, technique", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "3x5/jambe", "charge": "2x28kg", "notes": "L√©ger", "bloc": "Force"}, {"nom": "Lunges HALT√àRES", "series": "2x20m", "charge": "2x28kg", "notes": "Technique", "bloc": "Accessoires"}, {"nom": "Goblet Squat", "series": "3x6", "charge": "32kg", "notes": "L√©ger", "bloc": "Accessoires"}, {"nom": "SKIP Broad Jumps", "series": "", "charge": "", "notes": "Fra√Æcheur", "bloc": "Accessoires"}]}, {"numero": 12, "dates": "9-15 Mars", "notes": "Campus ~2.5h. Derni√®re s√©ance JEUDI 12 MARS max", "upper": [{"nom": "Bench Press Barre", "series": "2x3", "charge": "90kg", "notes": "Activation neurale", "bloc": "Force"}, {"nom": "Tirage Horizontal", "series": "2x5", "charge": "75kg", "notes": "L√©ger", "bloc": "Force"}, {"nom": "D√©velopp√© Inclin√© Halt√®res", "series": "2x5", "charge": "2x28kg", "notes": "Activation", "bloc": "Force"}, {"nom": "D√©velopp√© √âpaules", "series": "2x6", "charge": "2x20kg", "notes": "Technique", "bloc": "Accessoires"}, {"nom": "SKIP reste", "series": "", "charge": "", "notes": "Minimal", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "2x5", "charge": "80kg", "notes": "Activation", "bloc": "Force"}, {"nom": "Back Squat", "series": "2x3", "charge": "95kg", "notes": "Rotation: Back, neural", "bloc": "Force"}, {"nom": "Squat Bulgare", "series": "2x5/jambe", "charge": "2x24kg", "notes": "Technique", "bloc": "Force"}, {"nom": "Lunges HALT√àRES", "series": "1x20m", "charge": "2x24kg", "notes": "Rappel technique", "bloc": "Accessoires"}, {"nom": "SKIP reste", "series": "", "charge": "", "notes": "Fra√Æcheur absolue", "bloc": "Accessoires"}]}, {"numero": 13, "dates": "16-22 Mars", "notes": "Campus ~1.5h. Activation MAR 17. OFF MER-SAM. üî• COURSE DIM 22!", "upper": [{"nom": "Bench Press Barre", "series": "2x3", "charge": "90kg", "notes": "MARDI 17: Activation l√©g√®re", "bloc": "Force"}, {"nom": "Tirage Horizontal", "series": "2x5", "charge": "75kg", "notes": "Rappel mouvement", "bloc": "Force"}, {"nom": "Mobilit√©", "series": "10min", "charge": "", "notes": "√âpaules + dos", "bloc": "Force"}, {"nom": "SKIP", "series": "", "charge": "", "notes": "Repos absolue", "bloc": "Accessoires"}], "lower": [{"nom": "Hip Thrust Machine", "series": "2x5", "charge": "80kg", "notes": "MARDI 17: Activation", "bloc": "Force"}, {"nom": "Back Squat", "series": "2x3", "charge": "95kg", "notes": "Rappel mouvement", "bloc": "Force"}, {"nom": "Mobilit√©", "series": "10min", "charge": "", "notes": "Hanches + chevilles", "bloc": "Force"}, {"nom": "Lunges HALT√àRES", "series": "1x20m", "charge": "2x20kg", "notes": "Rappel l√©ger", "bloc": "Accessoires"}, {"nom": "SKIP reste", "series": "", "charge": "", "notes": "Repos", "bloc": "Accessoires"}]}], "hyrox": [{"numero": 1, "dates": "22-28 D√©c", "focus": "Focus: WB Technique + Adaptation", "echauffement": "5min mobilit√© (hanches, √©paules, chevilles)\n3x5 Broad Jumps (sans burpee)\n3x3 BBJ (technique)\n2x10 WB @ 6kg", "option_a": {"format": "EMOM 24min (8 rounds x 3min)", "contenu": "Min 1: 15 Wall Balls @ 9kg\nMin 2: 20m Lunges SANDBAG @ 28kg\nMin 3: 20 KB Swings @ 24kg", "notes": "Focus technique WB parfaite. Rythme constant."}, "option_b": {"format": "EMOM 24min (8 rounds x 3min)", "contenu": "Min 1: 15 Wall Balls @ 9kg\nMin 2: 250m Row @ mod√©r√©\nMin 3: 20 KB Swings @ 24kg", "notes": "Row remplace lunges si pluie. M√™me objectif technique."}, "cooldown": "5min √©tirements (quadriceps, √©paules, dos)", "objectifs": "‚Ä¢ Technique WB parfaite (squat profond, lancer fluide)\n‚Ä¢ Campus ~3h bas\n‚Ä¢ ISCHIO: Ski OK, pas rameur. Skip squash."}, {"numero": 2, "dates": "29 D√©c-4 Jan", "focus": "Focus: Sled Push Overload + BBJ", "echauffement": "5min mobilit√©\n3x2x12.5m Sled Push @ 150kg\n3x3 BBJ\n500m Row @ facile", "option_a": {"format": "5 rounds FOR TIME", "contenu": "4x12.5m Sled Push @ 210kg (pro+8kg)\n400m Run @ pace Hyrox (~4:15/km)\n2min30 repos entre rounds", "notes": "Objectif: <20min total. Sled: puissance, run: pace."}, "option_b": {"format": "5 rounds FOR TIME", "contenu": "4x12.5m Sled Push @ 210kg\n500m Row @ intensit√© √©lev√©e\n2min repos entre rounds", "notes": "Row remplace run, intensit√© similaire."}, "cooldown": "5min mobilit√© hanches + quadriceps", "objectifs": "‚Ä¢ Overload sled +8kg\n‚Ä¢ Campus ~3h bas\n‚Ä¢ ISCHIO: Toujours prudent rameur/squash"}, {"numero": 3, "dates": "5-11 Jan", "focus": "Focus: WB Endurance + Mix stations", "echauffement": "5min mobilit√©\n3x10 WB @ 6kg\n2x15 WB @ 9kg\n500m Ski @ facile", "option_a": {"format": "AMRAP 30min", "contenu": "30 Wall Balls @ 9kg\n100m Farmers @ 2x32kg (overload)\n20 Burpees\n400m Run", "notes": "Objectif: >4 rounds. Pas pause WB, farmers unbroken."}, "option_b": {"format": "AMRAP 30min", "contenu": "30 Wall Balls @ 9kg\n100m Farmers @ 2x32kg\n20 Burpees\n500m Ski", "notes": "Ski remplace run."}, "cooldown": "5min √©tirements √©paules + grip", "objectifs": "‚Ä¢ WB endurance 30 reps sans casser\n‚Ä¢ Campus HAUTE ~7h\n‚Ä¢ Test squash l√©ger fin semaine?"}, {"numero": 4, "dates": "12-18 Jan", "focus": "Focus: TEST STATIONS (Baseline)", "echauffement": "10min √©chauffement complet\nActivation toutes stations l√©g√®res", "option_a": {"format": "FOR TIME (Baseline)", "contenu": "1000m SkiErg\n4x12.5m Sled Push @ 202kg (poids pro exact)\n4x12.5m Sled Pull @ 153kg (poids pro exact)\n80m Burpee Broad Jump\n1000m Row", "notes": "CHRONO TOTAL. Baseline r√©f√©rence. Effort 85%."}, "option_b": {"format": "M√™me test", "contenu": "Identique Option A", "notes": "Test int√©rieur, pas besoin alternative."}, "cooldown": "10min r√©cup active + mobilit√©", "objectifs": "‚Ä¢ Temps total: ~18-20min objectif\n‚Ä¢ Campus DELOAD ~3h\n‚Ä¢ Test rameur 500m si ischio OK"}, {"numero": 5, "dates": "19-25 Jan", "focus": "Focus: WB + Sled Push Compromised", "echauffement": "5min mobilit√©\n3x10 WB @ 9kg\n2x2x12.5m Sled @ 180kg\n3x5 Burpees", "option_a": {"format": "10 rounds", "contenu": "500m Row @ intensit√© √©lev√©e\n15 Wall Balls @ 9kg\n45s repos", "notes": "Compromised WB apr√®s row. Objectif: <20min total."}, "option_b": {"format": "10 rounds", "contenu": "Alternate: 500m Row / 500m Ski\n15 Wall Balls @ 9kg\n45s repos", "notes": "Variation ergos."}, "cooldown": "5min √©tirements", "objectifs": "‚Ä¢ Compromised WB: tenir 15 reps apr√®s row\n‚Ä¢ Campus ~7h haute\n‚Ä¢ Ischio devrait √™tre OK maintenant"}, {"numero": 6, "dates": "26 Jan-1 F√©v", "focus": "Focus: Sled OVERLOAD MAX + Lunges", "echauffement": "5min mobilit√© hanches\n3x2x12.5m Sled @ 180kg\n2x20m Lunges SANDBAG @ 24kg\n500m Row", "option_a": {"format": "5 rounds", "contenu": "4x12.5m Sled Push @ 240kg (PRO+38kg OVERLOAD!)\n4x12.5m Sled Pull @ 180kg (PRO+27kg)\n400m Run @ pace cible\n3min repos", "notes": "OVERLOAD MAXIMUM! Effort 90%. Sensation force."}, "option_b": {"format": "5 rounds", "contenu": "4x12.5m Sled Push @ 240kg\n4x12.5m Sled Pull @ 180kg\n500m Bike @ haute intensit√©\n2min30 repos", "notes": "Bike remplace run."}, "cooldown": "10min √©tirements jambes", "objectifs": "‚Ä¢ Sled 240kg: confiance mentale\n‚Ä¢ Campus ~8h haute\n‚Ä¢ 202kg en course = \"l√©ger\" apr√®s overload"}, {"numero": 7, "dates": "2-8 F√©v", "focus": "Focus: Lunges Endurance + BBJ", "echauffement": "5min mobilit√©\n2x20m Lunges SANDBAG @ 24kg\n3x5 BBJ\n500m Row", "option_a": {"format": "EMOM 18min (6 rounds x 3min)", "contenu": "Min 1: 20m Lunges SANDBAG @ 30kg (poids pro)\nMin 2: 15 BBJ\nMin 3: 400m Run", "notes": "Focus lunges technique parfaite, BBJ distance constant."}, "option_b": {"format": "EMOM 18min", "contenu": "Min 1: 20m Lunges SANDBAG @ 30kg\nMin 2: 15 BBJ\nMin 3: 500m Row", "notes": "Row remplace run."}, "cooldown": "5min √©tirements", "objectifs": "‚Ä¢ Lunges pro: posture 100m\n‚Ä¢ Campus HAUTE ~9h\n‚Ä¢ BBJ: distance >4.5m/rep"}, {"numero": 8, "dates": "9-15 F√©v", "focus": "Focus: TEST + WB 100 reps", "echauffement": "10min √©chauffement complet\n2x15 WB @ 6kg\n3x5 WB @ 9kg", "option_a": {"format": "FOR TIME (Benchmark 2)", "contenu": "TEST 1: 100 Wall Balls @ 9kg FOR TIME\n(repos 5min)\nTEST 2: 80m BBJ FOR TIME\n(repos 5min)\nTEST 3: 4x12.5m Sled Push @ 202kg FOR TIME", "notes": "Tests isol√©s. Objectif: WB <4:15, BBJ <4min, Sled <3min."}, "option_b": {"format": "M√™me test", "contenu": "Identique", "notes": "Test int√©rieur."}, "cooldown": "10min r√©cup", "objectifs": "‚Ä¢ WB 100 reps: <4:15 = excellent\n‚Ä¢ Campus DELOAD ~3h\n‚Ä¢ Validation progression vs sem 4"}, {"numero": 9, "dates": "16-22 F√©v", "focus": "Focus: WB Sp√©cifique + Density", "echauffement": "5min mobilit√©\n3x10 WB @ 9kg\nActivation compl√®te", "option_a": {"format": "12 rounds", "contenu": "400m Run @ pace Hyrox exact\n20 Wall Balls @ 9kg\n30s repos", "notes": "DENSIT√â MAX. Sp√©cificit√© absolue. Effort 85%."}, "option_b": {"format": "12 rounds", "contenu": "Alternate: 500m Row / 500m Ski / 500m Bike\n20 Wall Balls @ 9kg\n30s repos", "notes": "Variation ergos."}, "cooldown": "5min √©tirements", "objectifs": "‚Ä¢ WB: 20 reps constant 12 rounds\n‚Ä¢ Campus HAUTE MAX ~11h\n‚Ä¢ Run pace exact: 4:15/km"}, {"numero": 10, "dates": "23 F√©v-1 Mars", "focus": "Focus: SIMULATION COMPL√àTE 1-8", "echauffement": "15min √©chauffement complet\nActivation l√©g√®re toutes stations", "option_a": {"format": "STATIONS 1-8 (80% effort)", "contenu": "1km Run + 1000m Ski + 1km Run\n4x12.5m Sled Push @ 202kg + 1km Run\n4x12.5m Sled Pull @ 153kg + 1km Run\n80m BBJ + 1km Run\n1000m Row + 1km Run\n200m Farmers @ 2x32kg + 1km Run\n100m Lunges SANDBAG @ 30kg + 1km Run\n100 Wall Balls @ 9kg", "notes": "SIMULATION COMPL√àTE. Effort 80%. Objectif: 1h10-1h12."}, "option_b": {"format": "M√™me simulation", "contenu": "Identique", "notes": "Simulation compl√®te int√©rieur."}, "cooldown": "15min r√©cup active", "objectifs": "‚Ä¢ Temps total: 1h10-1h12 = excellent\n‚Ä¢ Campus ~9h\n‚Ä¢ Valider strat√©gie pace + nutrition"}, {"numero": 11, "dates": "2-8 Mars", "focus": "Focus: TAPER - Technique l√©g√®re", "echauffement": "10min mobilit√© compl√®te\nActivation l√©g√®re", "option_a": {"format": "Technique L√©g√®re (40min max)", "contenu": "3x15 WB @ 9kg (technique parfaite)\n3x4x12.5m Sled Push @ 150kg (vitesse)\n3x20m Lunges SANDBAG @ 24kg (posture)\n3x10 BBJ (distance)\n500m Row @ facile", "notes": "VOLUME MINIMAL. Technique > Intensit√©."}, "option_b": {"format": "M√™me", "contenu": "Identique", "notes": "Pas besoin alternative."}, "cooldown": "10min √©tirements doux", "objectifs": "‚Ä¢ Maintenir connexion neuromusculaire\n‚Ä¢ Campus ~4h descente\n‚Ä¢ Z√âRO fatigue"}, {"numero": 12, "dates": "9-15 Mars", "focus": "Focus: TAPER - Activation minimale", "echauffement": "5min mobilit√© l√©g√®re", "option_a": {"format": "Activation (30min max)", "contenu": "2x10 WB @ 6kg (rappel mouvement)\n2x2x12.5m Sled Push @ 120kg (vitesse)\n2x20m Lunges SANDBAG @ 20kg (rappel)\n5 BBJ (technique)", "notes": "DERNI√àRE S√âANCE. JEUDI 12 MARS max. Repos jusqu'√† dim."}, "option_b": {"format": "SKIP", "contenu": "Repos complet si moindre doute", "notes": "Fra√Æcheur absolue prioritaire."}, "cooldown": "5min √©tirements l√©gers", "objectifs": "‚Ä¢ Rappel mouvements\n‚Ä¢ Campus ~2.5h\n‚Ä¢ Repos jeudi-samedi complet"}, {"numero": 13, "dates": "16-22 Mars", "focus": "Focus: RACE WEEK - Activation finale", "echauffement": "5min mobilit√© l√©g√®re", "option_a": {"format": "Activation (20min max)", "contenu": "MARDI 17 ou MERCREDI 18:\n2x10 WB @ 6kg (rappel)\n2x2x12.5m Sled Push @ 120kg (vitesse)\n2x20m Lunges SANDBAG @ 20kg\n5 BBJ (technique)", "notes": "Activation mar 17 ou mer 18. OFF jeu-sam."}, "option_b": {"format": "SKIP", "contenu": "Repos complet si d√©j√† frais", "notes": "Fra√Æcheur absolue = priorit√©."}, "cooldown": "5min √©tirements", "objectifs": "‚Ä¢ Rappel final mouvements\n‚Ä¢ Campus ~1.5h\n‚Ä¢ üî• COURSE DIMANCHE 22 MARS 2026! üî•"}], "campus": [{"numero": 1, "campus": "~3h"}, {"numero": 2, "campus": "~3h"}, {"numero": 3, "campus": "~7h"}, {"numero": 4, "campus": "~3h"}, {"numero": 5, "campus": "~7h"}, {"numero": 6, "campus": "~8h"}, {"numero": 7, "campus": "~9h"}, {"numero": 8, "campus": "~3h"}, {"numero": 9, "campus": "~11h"}, {"numero": 10, "campus": "~9h"}, {"numero": 11, "campus": "~4h"}, {"numero": 12, "campus": "~2.5h"}, {"numero": 13, "campus": "~1.5h"}], "finishers": {"upper": [{"code": "A2", "nom": "Upper Power", "duree": "10min", "format": "EMOM 10min", "contenu": "Min 1: 15 Burpees + 500m Bike\nMin 2: Repos\n(5 rounds)"}, {"code": "A3", "nom": "Row Intervals", "duree": "12min", "format": "6 rounds", "contenu": "500m Row @ haute intensit√©\n90s repos"}], "lower": [{"code": "B2", "nom": "Goblet + Burpees", "duree": "12min", "format": "AMRAP 12min", "contenu": "15 Goblet Squats @ 32kg\n10 Burpees\n20 KB Swings @ 24kg"}, {"code": "B3", "nom": "KB + Bike", "duree": "15min", "format": "EMOM 15min", "contenu": "Min 1: 20 KB @ 24kg\nMin 2: Max cals Bike 45s\nMin 3: Repos"}]}};
        
        let currentWeek = 0;
        let currentFilter = 'all';
        let completedSessions = loadCompletions();
        let hyroxHistory = loadHyroxHistory();
        let hyroxNotes = loadHyroxNotes();
        
        // Timer state
        let timerInterval = null;
        let timerStartTime = 0;
        let timerElapsed = 0;
        let timerPaused = false;
        let currentTimerConfig = null;
        let currentRound = 0;
        let currentMinute = 0;
        let roundTimes = [];
        let distanceViewMode = false;
        
        // Generate bell sound (simple sine wave)
        function initBellSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const duration = 0.3;
            const sampleRate = audioContext.sampleRate;
            const numSamples = duration * sampleRate;
            const buffer = audioContext.createBuffer(1, numSamples, sampleRate);
            const data = buffer.getChannelData(0);
            
            for (let i = 0; i < numSamples; i++) {
                const t = i / sampleRate;
                const freq = 800;
                const envelope = Math.exp(-t * 8);
                data[i] = Math.sin(2 * Math.PI * freq * t) * envelope * 0.3;
            }
            
            window.bellBuffer = buffer;
            window.audioContext = audioContext;
        }
        
        function playBell() {
            if (!window.audioContext || !window.bellBuffer) return;
            
            const source = window.audioContext.createBufferSource();
            source.buffer = window.bellBuffer;
            source.connect(window.audioContext.destination);
            source.start();
            
            // Vibration
            if (navigator.vibrate) {
                navigator.vibrate(200);
            }
        }
        
        // LocalStorage management
        function loadCompletions() {
            const saved = localStorage.getItem('hyrox_completions_v3');
            return saved ? JSON.parse(saved) : {};
        }
        
        function saveCompletions() {
            localStorage.setItem('hyrox_completions_v3', JSON.stringify(completedSessions));
            updateStats();
        }
        
        function loadHyroxHistory() {
            const saved = localStorage.getItem('hyrox_history_v3');
            return saved ? JSON.parse(saved) : {};
        }
        
        function saveHyroxHistory() {
            localStorage.setItem('hyrox_history_v3', JSON.stringify(hyroxHistory));
        }
        
        function loadHyroxNotes() {
            const saved = localStorage.getItem('hyrox_notes_v3');
            return saved ? JSON.parse(saved) : {};
        }
        
        function saveHyroxNotes() {
            localStorage.setItem('hyrox_notes_v3', JSON.stringify(hyroxNotes));
        }
        
        function toggleCompletion(weekNum, sessionType) {
            const key = `w${weekNum}-${sessionType}`;
            completedSessions[key] = !completedSessions[key];
            saveCompletions();
            
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
            
            showWeek(currentWeek);
        }
        
        function isCompleted(weekNum, sessionType) {
            const key = `w${weekNum}-${sessionType}`;
            return !!completedSessions[key];
        }
        
        // Update stats
        function updateStats() {
            const totalSessions = 13 * 3;
            const completed = Object.values(completedSessions).filter(v => v).length;
            const percentage = Math.round((completed / totalSessions) * 100);
            
            // Count Hyrox sessions
            let hyroxCount = 0;
            for (let i = 1; i <= 13; i++) {
                if (isCompleted(i, 'hyrox')) hyroxCount++;
            }
            
            document.getElementById('completedSessions').textContent = completed;
            document.getElementById('totalSessions').textContent = totalSessions;
            document.getElementById('globalProgress').textContent = percentage;
            document.getElementById('globalProgressBar').style.width = percentage + '%';
            document.getElementById('currentWeek').textContent = currentWeek + 1;
            document.getElementById('hyroxCompleted').textContent = hyroxCount;
            
            updateWeekButtons();
        }
        
        // Update countdown
        function updateCountdown() {
            const raceDate = new Date('2026-03-22');
            const today = new Date();
            const diffTime = raceDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            document.getElementById('countdown').textContent = diffDays;
        }
        
        // Get current week based on date
        function getCurrentWeekNumber() {
            const startDate = new Date('2025-12-22');
            const today = new Date();
            const diffTime = today - startDate;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            const weekNum = Math.floor(diffDays / 7);
            return Math.max(0, Math.min(12, weekNum));
        }
        
        // Filter sessions
        function filterSessions(type) {
            currentFilter = type;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                const btnType = btn.onclick.toString().match(/'(\w+)'/)[1];
                btn.classList.toggle('active', btnType === type);
            });
            
            document.querySelectorAll('.session-card').forEach(card => {
                if (type === 'all') {
                    card.classList.remove('hidden');
                } else {
                    const hasType = card.classList.contains(`session-${type}`);
                    card.classList.toggle('hidden', !hasType);
                }
            });
        }
        
        // Create week navigation
        function createWeekNav() {
            const nav = document.getElementById('weekNav');
            trainingData.musculation.forEach((week, index) => {
                const btn = document.createElement('button');
                btn.className = 'week-btn';
                btn.innerHTML = `S${week.numero}<span class="completion-indicator"></span>`;
                btn.onclick = () => {
                    currentWeek = index;
                    showWeek(index);
                };
                nav.appendChild(btn);
            });
        }
        
        // Update week buttons completion
        function updateWeekButtons() {
            const buttons = document.querySelectorAll('.week-btn');
            buttons.forEach((btn, index) => {
                const weekNum = index + 1;
                const upperDone = isCompleted(weekNum, 'upper');
                const lowerDone = isCompleted(weekNum, 'lower');
                const hyroxDone = isCompleted(weekNum, 'hyrox');
                
                btn.classList.toggle('active', index === currentWeek);
                
                if (upperDone && lowerDone && hyroxDone) {
                    btn.classList.add('completed');
                } else {
                    btn.classList.remove('completed');
                }
            });
        }
        
        // Render exercises
        function renderExercises(exercises) {
            const blocs = {};
            exercises.forEach(ex => {
                if (!blocs[ex.bloc]) blocs[ex.bloc] = [];
                blocs[ex.bloc].push(ex);
            });
            
            let html = '';
            for (const [bloc, exs] of Object.entries(blocs)) {
                const blocClass = bloc.toLowerCase();
                html += `
                    <div class="bloc-section">
                        <div class="bloc-title ${blocClass}">
                            ${bloc === 'Force' ? 'üî•' : '‚öôÔ∏è'} ${bloc}
                        </div>
                `;
                
                exs.forEach(ex => {
                    html += `
                        <div class="exercise">
                            <div class="exercise-name">${ex.nom}</div>
                            <div class="exercise-details">
                                ${ex.series ? `
                                    <div class="exercise-stat">
                                        <span class="stat-label">S√©ries</span>
                                        <span class="stat-value">${ex.series}</span>
                                    </div>
                                ` : ''}
                                ${ex.charge ? `
                                    <div class="exercise-stat">
                                        <span class="stat-label">Charge</span>
                                        <span class="stat-value">${ex.charge}</span>
                                    </div>
                                ` : ''}
                            </div>
                            ${ex.notes && ex.notes !== 'nan' ? `
                                <div class="exercise-notes">üí° ${ex.notes}</div>
                            ` : ''}
                        </div>
                    `;
                });
                
                html += '</div>';
            }
            
            return html;
        }
        

        // Render finishers for Upper/Lower
        function renderFinishers(weekNum, type) {
            const finishers = trainingData.finishers;
            if (!finishers) return '';
            
            const options = type === 'upper' ? finishers.upper : finishers.lower;
            if (!options || options.length === 0) return '';
            
            const selectedKey = 'w' + weekNum + '-' + type + '-finisher';
            const selected = localStorage.getItem(selectedKey);
            
            let html = '<div class="finishers-section" style="margin-top: 16px; padding: 16px; background: var(--bg-exercise); border-radius: 12px;">';
            html += '<div class="finishers-title" style="font-size: 14px; font-weight: 700; color: var(--accent-secondary); margin-bottom: 12px;">‚ö° Finisher (optionnel)</div>';
            html += '<div style="display: flex; gap: 12px; margin-bottom: 12px;">';
            
            options.forEach(function(opt, idx) {
                const isSelected = selected === opt.code;
                const bgColor = isSelected ? 'rgba(0, 255, 136, 0.1)' : 'var(--bg-card)';
                const borderColor = isSelected ? 'var(--accent-primary)' : 'var(--border)';
                
                html += '<div class="finisher-option" ';
                html += 'style="flex: 1; padding: 12px; background: ' + bgColor + '; ';
                html += 'border: 2px solid ' + borderColor + '; border-radius: 8px; cursor: pointer; transition: all 0.2s;" ';
                html += 'onclick="selectFinisher(' + weekNum + ', \'' + type + '\', \'' + opt.code + '\')">';
                html += '<div style="font-weight: 600; margin-bottom: 4px;">' + opt.code + ': ' + opt.nom + '</div>';
                html += '<div style="font-size: 12px; color: var(--text-muted);">' + opt.format + '</div>';
                html += '</div>';
            });
            
            html += '</div>';
            html += '<div id="finisherDetails-' + weekNum + '-' + type + '" style="display: ' + (selected ? 'block' : 'none') + ';">';
            
            options.forEach(function(opt) {
                const isSelected = selected === opt.code;
                html += '<div id="finisher-' + opt.code + '-' + weekNum + '" ';
                html += 'style="display: ' + (isSelected ? 'block' : 'none') + '; padding: 12px; background: var(--bg-card); border-radius: 8px; font-size: 13px; line-height: 1.6;">';
                html += '<strong>Contenu:</strong><br>';
                html += opt.contenu.replace(/\n/g, '<br>');
                html += '</div>';
            });
            
            html += '</div></div>';
            
            return html;
        }
        
        function selectFinisher(weekNum, type, code) {
            const key = 'w' + weekNum + '-' + type + '-finisher';
            const current = localStorage.getItem(key);
            
            if (current === code) {
                localStorage.removeItem(key);
            } else {
                localStorage.setItem(key, code);
            }
            
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
            
            showWeek(currentWeek);
        }

                // Render Hyrox session
        function renderHyroxSession(weekNum, hyrox) {
            const historyKey = `w${weekNum}`;
            const history = hyroxHistory[historyKey] || [];
            const notes = hyroxNotes[historyKey] || '';
            
            let html = `
                <div class="hyrox-options">
                    <div class="option-selector" id="optionA-${weekNum}" onclick="selectOption(${weekNum}, 'A')">
                        <div class="option-title">‚òÄÔ∏è Option A</div>
                        <div class="option-subtitle">Beau temps - Run</div>
                    </div>
                    <div class="option-selector" id="optionB-${weekNum}" onclick="selectOption(${weekNum}, 'B')">
                        <div class="option-title">üåßÔ∏è Option B</div>
                        <div class="option-subtitle">Pluie - Ergos</div>
                    </div>
                </div>
                
                <div class="hyrox-section">
                    <div class="hyrox-section-title">üéØ Focus</div>
                    <div class="hyrox-section-content">${hyrox.focus}</div>
                </div>
            `;
            
            if (hyrox.echauffement) {
                html += `
                    <div class="hyrox-section">
                        <div class="hyrox-section-title">üî• √âchauffement</div>
                        <div class="hyrox-section-content">${hyrox.echauffement}</div>
                    </div>
                `;
            }
            
            html += `
                <div class="hyrox-section" id="optionADetails-${weekNum}" style="display:none;">
                    <div class="hyrox-section-title">‚òÄÔ∏è Option A - D√©tails</div>
                    <div class="hyrox-section-content">
                        <strong>Format:</strong> ${hyrox.option_a.format}<br><br>
                        <strong>Contenu:</strong><br>${hyrox.option_a.contenu}
                        ${hyrox.option_a.notes ? `<br><br><strong>Notes:</strong> ${hyrox.option_a.notes}` : ''}
                    </div>
                </div>
                
                <div class="hyrox-section" id="optionBDetails-${weekNum}" style="display:none;">
                    <div class="hyrox-section-title">üåßÔ∏è Option B - D√©tails</div>
                    <div class="hyrox-section-content">
                        <strong>Format:</strong> ${hyrox.option_b.format}<br><br>
                        <strong>Contenu:</strong><br>${hyrox.option_b.contenu}
                        ${hyrox.option_b.notes ? `<br><br><strong>Notes:</strong> ${hyrox.option_b.notes}` : ''}
                    </div>
                </div>
            `;
            
            if (hyrox.objectifs) {
                html += `
                    <div class="hyrox-section">
                        <div class="hyrox-section-title">üéØ Objectifs</div>
                        <div class="hyrox-section-content">${hyrox.objectifs}</div>
                    </div>
                `;
            }
            
            html += `
                <button class="start-session-btn" id="startBtn-${weekNum}" onclick="startHyroxSession(${weekNum})" disabled>
                    ‚ñ∂Ô∏è D√©marrer la s√©ance
                </button>
                
                <div class="session-notes">
                    <div class="notes-label">üìù Notes de s√©ance</div>
                    <textarea class="notes-input" id="notes-${weekNum}" 
                        placeholder="Ajoute tes notes ici (sensations, temps, difficult√©s...)"
                        onchange="saveSessionNotes(${weekNum})">${notes}</textarea>
                </div>
            `;
            
            // History
            if (history.length > 0) {
                html += `
                    <div class="hyrox-history">
                        <div class="history-title">üìä Historique des s√©ances</div>
                `;
                
                history.forEach((session, idx) => {
                    const avgTime = session.roundTimes.length > 0 
                        ? (session.roundTimes.reduce((a, b) => a + b, 0) / session.roundTimes.length / 1000).toFixed(1)
                        : '--';
                    
                    html += `
                        <div class="history-item">
                            <div class="history-header" style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="display: flex; gap: 12px;">
                                    <span class="history-date">${new Date(session.date).toLocaleDateString('fr-FR')}</span>
                                    <span class="history-option">Option ${session.option}</span>
                                </div>
                                <button onclick="deleteHistory(${weekNum}, ${idx})" 
                                        style="padding: 4px 8px; background: var(--accent-rest); color: white; 
                                               border: none; border-radius: 4px; cursor: pointer; font-size: 11px;"
                                        title="Supprimer">
                                    üóëÔ∏è
                                </button>
                            </div>
                            <div class="history-stats">
                                <div>
                                    <div class="history-stat-label">Tours</div>
                                    <div class="history-stat-value">${session.roundTimes.length}</div>
                                </div>
                                <div>
                                    <div class="history-stat-label">Temps moy</div>
                                    <div class="history-stat-value">${avgTime}s</div>
                                </div>
                                <div>
                                    <div class="history-stat-label">Total</div>
                                    <div class="history-stat-value">${formatTime(session.totalTime)}</div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
            }
            
            return html;
        }
        
        let selectedOption = {};
        
        function selectOption(weekNum, option) {
            selectedOption[weekNum] = option;
            
            const optionA = document.getElementById(`optionA-${weekNum}`);
            const optionB = document.getElementById(`optionB-${weekNum}`);
            const detailsA = document.getElementById(`optionADetails-${weekNum}`);
            const detailsB = document.getElementById(`optionBDetails-${weekNum}`);
            const startBtn = document.getElementById(`startBtn-${weekNum}`);
            
            if (option === 'A') {
                optionA.classList.add('selected');
                optionB.classList.remove('selected');
                detailsA.style.display = 'block';
                detailsB.style.display = 'none';
            } else {
                optionB.classList.add('selected');
                optionA.classList.remove('selected');
                detailsB.style.display = 'block';
                detailsA.style.display = 'none';
            }
            
            startBtn.disabled = false;
            
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }
        
        function saveSessionNotes(weekNum) {
            const notes = document.getElementById(`notes-${weekNum}`).value;
            hyroxNotes[`w${weekNum}`] = notes;
            saveHyroxNotes();
        }

        function deleteHistory(weekNum, index) {
            if (!confirm('Supprimer cet historique ?')) return;
            
            const historyKey = 'w' + weekNum;
            if (hyroxHistory[historyKey]) {
                hyroxHistory[historyKey].splice(index, 1);
                if (hyroxHistory[historyKey].length === 0) {
                    delete hyroxHistory[historyKey];
                }
                saveHyroxHistory();
            }
            
            if (navigator.vibrate) {
                navigator.vibrate(100);
            }
            
            showWeek(currentWeek);
        }

        
        // Start Hyrox session
        function startHyroxSession(weekNum) {
            const option = selectedOption[weekNum];
            if (!option) return;
            
            const hyrox = trainingData.hyrox[weekNum - 1];
            const optionData = option === 'A' ? hyrox.option_a : hyrox.option_b;
            
            // Parse format to determine timer type
            const format = optionData.format.toLowerCase();
            let timerType = 'simple';
            let config = {
                weekNum: weekNum,
                option: option,
                type: 'simple',
                totalRounds: 0,
                minutesPerRound: 0,
                exercises: [],
                restTime: 0
            };
            
            // Detect EMOM
            if (format.includes('emom')) {
                const match = format.match(/(\d+)min.*?(\d+)\s*rounds.*?(\d+)min/i);
                if (match) {
                    const totalMin = parseInt(match[1]);
                    const rounds = parseInt(match[2]);
                    const minPerRound = parseInt(match[3]);
                    
                    config.type = 'emom';
                    config.totalRounds = rounds;
                    config.minutesPerRound = minPerRound;
                    
                    // Parse exercises from content
                    const lines = optionData.contenu.split('\n');
                    lines.forEach(line => {
                        if (line.includes('Min') && line.includes(':')) {
                            const parts = line.split(':');
                            if (parts.length > 1) {
                                config.exercises.push(parts[1].trim());
                            }
                        }
                    });
                }
            }
            // Detect FOR TIME
            else if (format.includes('for time') || format.includes('rounds')) {
                const match = format.match(/(\d+)\s*rounds/i);
                if (match) {
                    config.type = 'fortime';
                    config.totalRounds = parseInt(match[1]);
                    
                    // Check for rest time
                    const restMatch = optionData.contenu.match(/(\d+)min(\d+)?\s*repos/i);
                    if (restMatch) {
                        const restMin = parseInt(restMatch[1]);
                        const restSec = restMatch[2] ? parseInt(restMatch[2]) : 0;
                        config.restTime = (restMin * 60 + restSec) * 1000;
                    }
                    
                    config.exercises = [optionData.contenu.split('\n')[0]];
                }
            }
            // Detect AMRAP
            else if (format.includes('amrap')) {
                config.type = 'amrap';
                const match = format.match(/(\d+)min/i);
                if (match) {
                    config.totalTime = parseInt(match[1]) * 60 * 1000;
                }
            }
            
            openTimer(config);
        }
        
        // Timer functions
        function openTimer(config) {
            currentTimerConfig = config;
            currentRound = 0;
            currentMinute = 0;
            roundTimes = [];
            timerElapsed = 0;
            timerPaused = false;
            distanceViewMode = false;
            
            const modal = document.getElementById('timerModal');
            const container = document.getElementById('timerContainer');
            
            document.getElementById('timerWeek').textContent = `Semaine ${config.weekNum} - Option ${config.option}`;
            
            if (config.type === 'emom') {
                document.getElementById('timerType').textContent = 'EMOM ' + (config.totalRounds * config.minutesPerRound) + 'min';
            } else if (config.type === 'fortime') {
                document.getElementById('timerType').textContent = config.totalRounds + ' Rounds FOR TIME';
            } else if (config.type === 'amrap') {
                document.getElementById('timerType').textContent = 'AMRAP ' + (config.totalTime / 60000) + 'min';
            } else {
                document.getElementById('timerType').textContent = 'Chrono Simple';
            }
            
            updateTimerDisplay();
            renderTimerControls();
            
            modal.classList.add('active');
            container.classList.remove('distance-view');
        }
        
        function closeTimer() {
            if (timerInterval) {
                if (confirm('Arr√™ter la s√©ance en cours ?')) {
                    stopTimer();
                    document.getElementById('timerModal').classList.remove('active');
                }
            } else {
                document.getElementById('timerModal').classList.remove('active');
            }
        }
        
        function startTimer() {
            if (timerInterval) return;
            
            timerStartTime = Date.now() - timerElapsed;
            timerPaused = false;
            
            timerInterval = setInterval(() => {
                timerElapsed = Date.now() - timerStartTime;
                updateTimerDisplay();
                checkTimerEvents();
            }, 100);
            
            renderTimerControls();
        }
        
        function pauseTimer() {
            if (!timerInterval) return;
            
            clearInterval(timerInterval);
            timerInterval = null;
            timerPaused = true;
            renderTimerControls();
        }
        
        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            // Save to history
            const historyKey = `w${currentTimerConfig.weekNum}`;
            if (!hyroxHistory[historyKey]) {
                hyroxHistory[historyKey] = [];
            }
            
            hyroxHistory[historyKey].push({
                date: new Date().toISOString(),
                option: currentTimerConfig.option,
                type: currentTimerConfig.type,
                totalTime: timerElapsed,
                roundTimes: roundTimes
            });
            
            saveHyroxHistory();
            
            // Mark as completed
            completedSessions[`w${currentTimerConfig.weekNum}-hyrox`] = true;
            saveCompletions();
            
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100]);
            }
        
            
            // Vider l'affichage des rounds (l'historique global est sauvegard√©)
            const roundList = document.getElementById('roundList');
            const roundHistory = document.getElementById('roundHistory');
            if (roundList) roundList.innerHTML = '';
            if (roundHistory) roundHistory.style.display = 'none';
            
        }
        
        function completeRound() {
            roundTimes.push(timerElapsed - roundTimes.reduce((a, b) => a + b, 0));
            currentRound++;
            
            if (navigator.vibrate) {
                navigator.vibrate(200);
            }
            
            playBell();
            
            // Update history display
            updateRoundHistory();
            
            // Pour FOR TIME: chrono continue, pas d'arr√™t auto
            // L'utilisateur doit cliquer "Terminer" manuellement
            
            renderTimerControls();
        }
        
        function toggleDistanceView() {
            distanceViewMode = !distanceViewMode;
            const container = document.getElementById('timerContainer');
            container.classList.toggle('distance-view', distanceViewMode);
            renderTimerControls();
        }
        
        function updateTimerDisplay() {
            const timeDisplay = document.getElementById('timerTime');
            timeDisplay.textContent = formatTime(timerElapsed);
            
            if (currentTimerConfig.type === 'emom') {
                const totalSeconds = Math.floor(timerElapsed / 1000);
                const currentMinInRound = totalSeconds % (currentTimerConfig.minutesPerRound * 60);
                const newMinute = Math.floor(currentMinInRound / 60);
                const newRound = Math.floor(totalSeconds / (currentTimerConfig.minutesPerRound * 60));
                
                if (newRound !== currentRound && newRound < currentTimerConfig.totalRounds) {
                    currentRound = newRound;
                    currentMinute = 0;
                    playBell();
                } else if (newMinute !== currentMinute) {
                    currentMinute = newMinute;
                    playBell();
                }
                
                document.getElementById('timerRound').textContent = `Round ${currentRound + 1}/${currentTimerConfig.totalRounds}`;
                document.getElementById('timerMinute').textContent = `Minute ${currentMinute + 1}/${currentTimerConfig.minutesPerRound}`;
                
                const exerciseIdx = currentMinute % currentTimerConfig.exercises.length;
                document.getElementById('timerExercise').textContent = currentTimerConfig.exercises[exerciseIdx] || '';
                document.getElementById('timerDetails').textContent = '';
            } else if (currentTimerConfig.type === 'fortime') {
                document.getElementById('timerRound').textContent = `Round ${currentRound + 1}/${currentTimerConfig.totalRounds}`;
                document.getElementById('timerMinute').textContent = '';
                
                // Afficher TOUS les exercices de la s√©ance
                const allExercises = currentTimerConfig.exercises.join(' + ');
                document.getElementById('timerExercise').textContent = allExercises || 'FOR TIME';
                document.getElementById('timerDetails').textContent = '';
            } else {
                document.getElementById('timerRound').textContent = '';
                document.getElementById('timerMinute').textContent = '';
                document.getElementById('timerExercise').textContent = 'Chrono en cours';
                document.getElementById('timerDetails').textContent = '';
            }
        }
        
        function checkTimerEvents() {
            // Auto-complete EMOM rounds
            if (currentTimerConfig.type === 'emom') {
                const totalSeconds = Math.floor(timerElapsed / 1000);
                const shouldBeRound = Math.floor(totalSeconds / (currentTimerConfig.minutesPerRound * 60));
                
                if (shouldBeRound > currentRound && shouldBeRound <= currentTimerConfig.totalRounds) {
                    // Auto-advance round
                }
            }
        }
        
        function updateRoundHistory() {
            const historyDiv = document.getElementById('roundHistory');
            const listDiv = document.getElementById('roundList');
            
            if (roundTimes.length === 0) {
                historyDiv.style.display = 'none';
                return;
            }
            
            historyDiv.style.display = 'block';
            
            let html = '';
            roundTimes.forEach((time, idx) => {
                html += `
                    <div class="round-item">
                        <span class="round-number">Tour ${idx + 1}</span>
                        <span class="round-time">${formatTime(time)}</span>
                    </div>
                `;
            });
            
            listDiv.innerHTML = html;
        }
        
        function renderTimerControls() {
            const controls = document.getElementById('timerControls');
            
            if (!timerInterval && timerElapsed === 0) {
                // Not started
                controls.innerHTML = `
                    <button class="timer-btn timer-btn-primary" onclick="startTimer()">
                        ‚ñ∂Ô∏è D√©marrer
                    </button>
                    <button class="timer-btn timer-btn-secondary" onclick="closeTimer()">
                        ‚úï Annuler
                    </button>
                `;
            } else if (timerInterval) {
                // Running
                let html = `
                    <button class="timer-btn timer-btn-secondary" onclick="pauseTimer()">
                        ‚è∏Ô∏è Pause
                    </button>
                `;
                
                if (currentTimerConfig.type === 'fortime') {
                    html += `
                        <button class="timer-btn timer-btn-primary" onclick="completeRound()">
                            ‚úì Tour fini
                        </button>
                    `;
                }
                
                html += `
                    <button class="timer-btn timer-btn-danger" onclick="stopTimer(); closeTimer();">
                        ‚èπÔ∏è Terminer
                    </button>
                `;
                
                if (!distanceViewMode) {
                    html += `
                        <button class="timer-btn timer-btn-secondary" onclick="toggleDistanceView()">
                            üì∫ Vue distance
                        </button>
                    `;
                }
                
                controls.innerHTML = html;
            } else if (timerPaused) {
                // Paused
                controls.innerHTML = `
                    <button class="timer-btn timer-btn-primary" onclick="startTimer()">
                        ‚ñ∂Ô∏è Reprendre
                    </button>
                    <button class="timer-btn timer-btn-danger" onclick="stopTimer(); closeTimer();">
                        ‚èπÔ∏è Terminer
                    </button>
                `;
            }
            
            if (distanceViewMode) {
                controls.innerHTML = `
                    <button class="timer-btn timer-btn-secondary" onclick="toggleDistanceView()">
                        ‚Üê Retour normal
                    </button>
                `;
            }
        }
        
        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // Show specific week
        function showWeek(index) {
            currentWeek = index;
            
            document.querySelectorAll('.week-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i === index);
            });
            
            const weekMuscu = trainingData.musculation[index];
            const weekHyrox = trainingData.hyrox[index];
            const weekNum = weekMuscu.numero;
            
            const upperCompleted = isCompleted(weekNum, 'upper');
            const lowerCompleted = isCompleted(weekNum, 'lower');
            const hyroxCompleted = isCompleted(weekNum, 'hyrox');
            
            const weekProgress = Math.round(
                ([upperCompleted, lowerCompleted, hyroxCompleted].filter(Boolean).length / 3) * 100
            );
            
            const content = document.getElementById('weekContent');
            
            content.innerHTML = `
                <div class="week-display active">
                    <div class="week-header">
                        <div class="week-title">
                            <h2>Semaine ${weekMuscu.numero}</h2>
                            <span class="week-dates">${weekMuscu.dates}</span>
                        </div>
                        <div class="week-progress">
                            <div class="week-progress-label">
                                <span>Progression de la semaine</span>
                                <span>${weekProgress}%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${weekProgress}%"></div>
                            </div>
                        </div>
                        ${weekMuscu.notes && weekMuscu.notes !== 'nan' ? `
                            <div class="week-notes">‚ö†Ô∏è ${weekMuscu.notes}</div>
                        ` : ''}
                    </div>
                    
                    <div class="sessions">
                        <div class="session-card session-upper ${upperCompleted ? 'completed' : ''}">
                            <div class="session-header">
                                <div class="session-type">
                                    <div class="session-icon upper">üí™</div>
                                    <span class="session-name">Upper Body</span>
                                </div>
                                <div class="session-actions">
                                    <span class="session-badge">Consultation</span>
                                    <div class="checkbox-container" onclick="toggleCompletion(${weekNum}, 'upper')">
                                        <div class="checkbox ${upperCompleted ? 'checked' : ''}"></div>
                                        <span class="checkbox-label">Fait</span>
                                    </div>
                                </div>
                            </div>
                            <div class="exercise-list">
                                ${renderExercises(weekMuscu.upper)}
                            
                                ${renderFinishers(weekNum, 'upper')}
                            </div>
                        </div>
                        
                        <div class="session-card session-lower ${lowerCompleted ? 'completed' : ''}">
                            <div class="session-header">
                                <div class="session-type">
                                    <div class="session-icon lower">ü¶µ</div>
                                    <span class="session-name">Lower Body</span>
                                </div>
                                <div class="session-actions">
                                    <span class="session-badge">Consultation</span>
                                    <div class="checkbox-container" onclick="toggleCompletion(${weekNum}, 'lower')">
                                        <div class="checkbox ${lowerCompleted ? 'checked' : ''}"></div>
                                        <span class="checkbox-label">Fait</span>
                                    </div>
                                </div>
                            </div>
                            <div class="exercise-list">
                                ${renderExercises(weekMuscu.lower)}
                            
                                ${renderFinishers(weekNum, 'lower')}
                            </div>
                        </div>
                        
                        <div class="session-card session-hyrox ${hyroxCompleted ? 'completed' : ''}">
                            <div class="session-header">
                                <div class="session-type">
                                    <div class="session-icon hyrox">‚ö°</div>
                                    <span class="session-name">Hyrox Sp√©cifique</span>
                                </div>
                                <div class="session-actions">
                                    <span class="session-badge">Timer PRO</span>
                                    <div class="checkbox-container" onclick="toggleCompletion(${weekNum}, 'hyrox')">
                                        <div class="checkbox ${hyroxCompleted ? 'checked' : ''}"></div>
                                        <span class="checkbox-label">Fait</span>
                                    </div>
                                </div>
                            </div>
                            <div class="hyrox-content">
                                ${renderHyroxSession(weekNum, weekHyrox)}
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            filterSessions(currentFilter);
        }
        
        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft' && currentWeek > 0) {
                currentWeek--;
                showWeek(currentWeek);
            } else if (e.key === 'ArrowRight' && currentWeek < 12) {
                currentWeek++;
                showWeek(currentWeek);
            }
        });
        
        // Initialize
        initBellSound();
        updateCountdown();
        createWeekNav();
        
        // Set to current week based on date
        currentWeek = getCurrentWeekNumber();
        showWeek(currentWeek);
        updateStats();
        
        setInterval(updateCountdown, 3600000);
    </script>

    <!-- Fix timer pour afficher tous les exercices -->
    <script src="hyrox-timer-fix.js"></script>
</body>
</html>